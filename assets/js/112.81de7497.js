(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{512:function(t,a,r){"use strict";r.r(a);var v=r(43),e=Object(v.a)({},(function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"javascript引擎"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#javascript引擎"}},[t._v("#")]),t._v(" JavaScript引擎")]),t._v(" "),r("p",[t._v("https://juejin.cn/post/7062645899956060174")]),t._v(" "),r("h2",{attrs:{id:"js引擎"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#js引擎"}},[t._v("#")]),t._v(" JS引擎")]),t._v(" "),r("h3",{attrs:{id:"jit"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#jit"}},[t._v("#")]),t._v(" JIT")]),t._v(" "),r("p",[t._v("JIT, Just In Time Compilation，即时编译，在运行时编译成机器代码。")]),t._v(" "),r("p",[t._v("对应的是AOT，Ahead Of Time Compilation，提前编译，运行前编译")]),t._v(" "),r("h2",{attrs:{id:"v8"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#v8"}},[t._v("#")]),t._v(" V8")]),t._v(" "),r("p",[t._v("优化后的V8引擎(版本5.9起)")]),t._v(" "),r("ol",[r("li",[t._v("语法分析-语法分析结果AST")]),t._v(" "),r("li",[t._v("解释执行-回收AST空间")]),t._v(" "),r("li",[t._v("性能分析\n"),r("ul",[r("li",[t._v("热点函数-持久化为机器码")]),t._v(" "),r("li",[t._v("非热点函数-"),r("s",[t._v("回退到AST")]),t._v("-由解释器执行")])])])]),t._v(" "),r("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://pic3.zhimg.com/80/v2-4c123fa841100bbf4adf8af8923337ce_1440w.jpg"}}),t._v(" "),r("h3",{attrs:{id:"核心模块"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#核心模块"}},[t._v("#")]),t._v(" 核心模块")]),t._v(" "),r("ul",[r("li",[t._v("解析器Parser\n"),r("ul",[r("li",[t._v("词法分析和语法分析将JavaScript源码"),r("strong",[t._v("解析")]),t._v("为AST")])])]),t._v(" "),r("li",[t._v("解释器 Ignition\n"),r("ul",[r("li",[t._v("将 AST "),r("strong",[t._v("解释")]),t._v("生成字节码并"),r("strong",[t._v("执行")]),t._v("，这个过程中会收集优化编译所需要的执行反馈信息，交给 TurboFan 进行优化编译。")]),t._v(" "),r("li",[t._v("字节码是跨平台的一种中间表示，可以运行在不同的操作系统上。然后AST会被清除以释放内存空间。")])])]),t._v(" "),r("li",[t._v("优化编译器TurboFan\n"),r("ul",[r("li",[t._v("根据 Ignition 收集的反馈信息，将字节码编译为优化后的机器码，后续 Ignition 用优化机器码代替字节码执行，进而提升性能。")]),t._v(" "),r("li",[t._v("根据相应的平台编译生成适配的机器码，其实是汇编代码")]),t._v(" "),r("li",[t._v("JIT即时编译，通过JIT可以极大提升JavaScript代码的执行性能。")])])])]),t._v(" "),r("p",[r("img",{attrs:{src:"https://pic3.zhimg.com/80/v2-d8777e18234367f87c7e7da34f607e86_1440w.jpg",alt:""}})]),t._v(" "),r("h3",{attrs:{id:"优化策略"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#优化策略"}},[t._v("#")]),t._v(" 优化策略")]),t._v(" "),r("p",[t._v("首先第一步的解析中，如果函数只被声明但未调用执行，则不会被生成AST。")]),t._v(" "),r("p",[t._v("第二步的interpreter中，如果函数只被执行一次，则会在字节码阶段直接被解释执行。如果一个函数被多次调用，那么就会被标记为热点函数，那么就会经过TurboFan转换成优化的机器码，提高代码的执行性能。例如由于JavaScript是弱类型，所以V8会帮忙推断数据类型。")]),t._v(" "),r("p",[t._v("如果 Ignition 收集的信息可能是错误的，那这个优化后的机器码就会被反编译成bytecode，然后重新再编译成正确的机器码。")]),t._v(" "),r("p",[t._v("好处：")]),t._v(" "),r("ol",[r("li",[t._v("由于一开始不需要直接编译成机器码，生成了中间层的字节码，从而节约了时间")]),t._v(" "),r("li",[t._v("优化编译阶段，不需要从源码重新解析，直接通过字节码进行优化，也可以deoptimization回退操作")])]),t._v(" "),r("h3",{attrs:{id:"其它"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#其它"}},[t._v("#")]),t._v(" 其它")]),t._v(" "),r("p",[t._v("V8 本质上是一个虚拟机，V8 也是早于其他虚拟机引入了惰性编译、内联缓存、隐藏类等机制，进一步优化了 JavaScript 代码的编译执行效率。")]),t._v(" "),r("h2",{attrs:{id:"event-loop"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#event-loop"}},[t._v("#")]),t._v(" Event Loop")]),t._v(" "),r("h2",{attrs:{id:"quickjs"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#quickjs"}},[t._v("#")]),t._v(" QuickJS")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/bellard/quickjs",target:"_blank",rel:"noopener noreferrer"}},[t._v("QuickJS Javascript Engine"),r("OutboundLink")],1)]),t._v(" "),r("h1",{attrs:{id:"参考"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://juejin.cn/post/7062645899956060174",target:"_blank",rel:"noopener noreferrer"}},[t._v("浅谈V8脚本引擎的工作原理（三.V8核心模块：解析器，解释器，优化编译器）"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("a",{attrs:{href:"https://juejin.cn/post/6844903890295455758",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript深入浅出第4课：V8引擎是如何工作的？"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/266708344",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器是如何工作的：Chrome V8让你更懂JavaScript"),r("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);