# 自适应/响应式布局

## 像素Pixel

| 像素                          |          |                                                              |
| ----------------------------- | -------- | ------------------------------------------------------------ |
| 设备像素 / 物理像素           | 物理设备 | 屏幕实际单位，是设备控制显示的最小单位，<br />固定不变，只与设备的硬件密度有关 |
| 逻辑像素 / 设备独立像素(DIPs) | 操作系统 | 逻辑上衡量像素的虚拟单位，与设备的像素密度相关，<br />操作系统基于设备像素比，将其转换为合理的物理像素 |
| CSS像素                       | 浏览器   | 为web开发者提供，在css中使用的一个抽象单位                   |

设备的单位像素密度(DPI，dots per inch)，只与设备屏幕相关

### 1）css像素与设备独立像素

视图缩放时，**元素的** css 像素数量不会改变，改变的只是每个 css 像素的大小

- 缩放比例 = css像素 / 设备独立像素
- 缩放比例100%时，像素相等
- 缩放比例200%时，1个css 像素大小 =  (2 * 2) 个设备独立像素

### 2）css像素与设备像素

设备<mark>像素比</mark> = 设备像素分辨率 / CSS 像素分辨率 = 1个CSS像素大小 / 1个设备像素大小（相同长度下的像素数量比）

- `window.devicePixelRatio` ，告诉浏览器应使用多少设备像素来绘制单个CSS像素
  - 无视网膜设备为`1`，视网膜设备(Retina)为`2`
  - 在iOS设备，`screen.width`乘以`devicePixelRatio`得到的是物理像素值。
  
  - 在Android以及Windows Phone设备，`screen.width`除以`devicePixelRatio`得到的是设备独立像素(dips)值。
  
- 视图缩放时，设备像素比会等比例发生变化，缩小50%时值就从原来的2变为1，放大50%则变为3

> 我理解，设备独立像素比更偏向用于衡量块的像素大小，而设备像素比是边长的像素大小比。两者不冲突，css像素转换为设备独立像素，后者在操作系统的解析下，转换为屏幕设备像素。(CSS像素/浏览器  -->  设备独立像素/操作系统  -->  物理像素/硬件设备  )，多了中间这一步是因为，像素适配交由操作系统来实现，而无须应用程序中通过window.devicePixelRatio等API再手动适配。

《高程4》中的像素比

> CSS 像素是 Web 开发中使用的统一像素单位。这个单位的背后其实是一个角度:0.0213°。如果屏幕距离人眼是一臂长，则以这个角度计算的 CSS 像素大小约为 1/96 英寸。这样定义像素大小是为了在不同设备上统一标准。比如，低分辨率平板设备上 12 像素(CSS 像素)的文字应该与高清 4K 屏幕下 12 像素(CSS 像素)的文字具有相同大小。这就带来了一个问题，不同像素密度的屏幕下就会有不同的 缩放系数，以便把物理像素(屏幕实际的分辨率)转换为 CSS 像素(浏览器报告的虚拟分辨率)。
>
> 举个例子，手机屏幕的物理分辨率可能是 1920×1080，但因为其像素可能非常小，所以浏览器就需要将其分辨率降为较低的逻辑分辨率，比如 640×320。这个物理像素与 CSS 像素之间的转换比率由 window.devicePixelRatio 属性提供。对于分辨率从 1920×1080 转换为 640×320 的设备，window.devicePixelRatio 的值就是 3。这样一来，12 像素(CSS 像素)的文字实际上就会用 36 像素的物理 像素来显示。
>
> window.devicePixelRatio 实际上与每英寸像素数(DPI，dots per inch)是对应的。DPI 表示单位像素密度，而 window.devicePixelRatio 表示物理像素与逻辑像素之间的缩放系数。

## 视口Viewpoint

| 类型                        |                                                              |
| --------------------------- | ------------------------------------------------------------ |
| 布局视口（layout viewport） | 网页布局的区域（html内容的真实渲染区域，包含可视区以外需要手指滑动的区域） |
| 视觉视口（visual viewport） | 网页在屏幕上显示的区域                                       |
| 理想视口（ideal viewport）  | 这时视口宽度等于移动设备的屏幕宽度（分辨率）                 |



## rem

rem（font size of the root element）相对于根元素`<html>`font-size 计算值的倍数



## vw、wh

css3中引入，在被浏览器广泛支持以前，常用方案是阿里的 [lib-flexible](https://github.com/amfe/lib-flexible)，使用 js 动态来设置根字体，本质上也是在模拟 viewpoint 的效果

| 单位 | 含义                              |
| ---- | --------------------------------- |
| vw   | 相对于视窗的宽度，视窗宽度是100vw |
| vh   | 相对于视窗的高度，视窗高度是100vh |
| vmin | vw和vh中的较小值                  |
| vmax | vw和vh中的较大值                  |



# 参考

[响应式布局的常用解决方案对比(媒体查询、百分比、rem和vw/vh）](https://github.com/forthealllight/blog/issues/13)

[2022 年移动端适配方案指南 — 全网最新最全 - 掘金](https://juejin.cn/post/7046169975706353701)
