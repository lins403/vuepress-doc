# Git ç‰¹æ€§

## ä¸€ã€ç‰ˆæœ¬æ§åˆ¶

è®°å½•æ–‡ä»¶å†å²å˜åŒ–ï¼Œä¾¿äºå›¢é˜Ÿçš„åä½œå¼€å‘

### 1. é›†ä¸­å¼

Centralized Version Control Systemsï¼Œç®€ç§° CVCS

ç‰ˆæœ¬åº“é›†ä¸­å­˜æ”¾åœ¨ä¸­å¤®æœåŠ¡å™¨

- æ¯æ¬¡éœ€è¦å…ˆæ‹‰å–æœ€æ–°ç‰ˆæœ¬ä½œä¸ºæœ¬åœ°å‰¯æœ¬ï¼ˆlocal copyï¼Œå¯ä»¥ä¸æ˜¯å®Œæ•´çš„é¡¹ç›®ä»£ç ï¼‰ï¼Œå·¥ä½œå®Œæˆä»¥åå°†ä¿®æ”¹æ¨é€å›æœåŠ¡å™¨ã€‚
- ä¸€èˆ¬åªæœ‰ä¸€ä¸ªä¸»ä»“åº“ä¸€ä¸ªä¸»åˆ†æ”¯ï¼Œä¿®æ”¹éƒ½ä¼šç›´æ¥è¢«commitè‡³ä¸»åˆ†æ”¯ï¼Œç„¶åè§£å†³åˆå¹¶å†²çªã€‚
- æ‰€æœ‰çš„å‘½ä»¤éƒ½è¦å’Œä¸­å¤®æœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œå½±å“å¼€å‘æ•ˆç‡ã€‚
- SVNã€CVS

#### ä¼˜ç‚¹

- å¯ä»¥æ›´å¥½çš„å¤„ç†**äºŒè¿›åˆ¶æ–‡ä»¶**ï¼ˆå¤ªå¤æ‚çš„äºŒè¿›åˆ¶æˆ–XMLæ–‡ä»¶ï¼Œå æ®ç©ºé—´è¾ƒå¤§ï¼Œåˆ†å¸ƒå¼éœ€è¦å…¨éƒ¨å®Œæ•´çš„æ‹‰å–ï¼Œé›†ä¸­å¼å¯ä»¥åªæ‹‰å–éƒ¨åˆ†ä»£ç ï¼Œæ•ˆç‡æ›´é«˜ï¼‰
- å¯ä»¥ä½¿ç”¨æ–‡ä»¶é”æœºåˆ¶ï¼ˆfile lockingï¼‰ï¼Œä¿è¯æ–‡ä»¶æ¯æ¬¡åªæœ‰ä¸€ä¸ªç”¨æˆ·å¯ä»¥ä¿®æ”¹ï¼Œè§£å†³åˆå¹¶å†²çªä»¥åå†æ‰“å¼€
- æ“ä½œç®€æ˜“ã€å­¦ä¹ æˆæœ¬ä½ï¼Œä¾¿äºç®¡ç†å‘˜æ§åˆ¶æƒé™å’Œç»´æŠ¤
- é€‚åˆèƒ½å¤Ÿå¿«é€Ÿæ²Ÿé€šçš„å°å›¢é˜Ÿ

#### ç¼ºç‚¹

- å•ç‚¹æ•…éšœï¼Œå¯¼è‡´æ•°æ®ï¼ˆé¡¹ç›®çš„æ•´ä¸ªå˜æ›´å†å²ï¼‰ä¸¢å¤±çš„é£é™©
- ç½‘ç»œæ•…éšœï¼Œä¼šç›´æ¥å¯¼è‡´å›¢é˜Ÿçš„åä½œå¼€å‘åœæ»
- ä¸ç¨³å®šï¼Œå½±å“å¼€å‘æ•ˆç‡
  - æ‰€æœ‰å‘½ä»¤éƒ½éœ€è¦è”ç½‘ä¸ä¸­å¤®æœåŠ¡å™¨äº¤äº’
  - åŒå—ä»£ç çš„ä¿®æ”¹éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªäººçš„ä¿®æ”¹æäº¤ä¸”è§£å†³åˆå¹¶å†²çªä»¥åï¼Œåè€…æ‰èƒ½æäº¤

### 2. åˆ†å¸ƒå¼

Distributed Version Control Systemï¼Œç®€ç§° DVCS

æ¯ä¸ªäººçš„æœ¬åœ°éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬åº“ï¼ŒåŒ…æ‹¬å®Œæ•´çš„ä»£ç ã€å˜æ›´å†å²ã€åˆ†æ”¯ç­‰ç­‰

- ä¸­å¤®æœåŠ¡å™¨çš„æ„ä¹‰æ˜¯ä¸ºäº†å¼€å‘è€…ä¹‹é—´äº¤æ¢ä»£ç æ›´æ–°ï¼Œè¿™ä¹Ÿæ˜¯å¼€å‘è€…å”¯ä¸€éœ€è¦è”ç½‘çš„æ“ä½œ
- Gitã€Mercurialã€Bazaar ä»¥åŠ Darcs 

#### ä¼˜ç‚¹

- å®‰å…¨æ€§è¾ƒé«˜ï¼Œä¸ç”¨æ‹…å¿ƒå•ç‚¹æ•…éšœï¼Œè€Œä¸”é”™è¯¯æ“ä½œå¤šäº†å¯ä»¥é€šè¿‡æœ¬åœ°ç‰ˆæœ¬æ¥æ¢å¤è¿™ä¸€é€”å¾„
- å¯ä»¥ç¦»çº¿å·¥ä½œï¼Œå¯ä»¥å…ˆåœ¨æœ¬åœ°å®Œæˆæäº¤
- Git é€Ÿåº¦å¾ˆå¿«ï¼Œä¸”gitçš„ä¸‰å¤§ç‰¹è‰²ï¼šBranchã€Stageã€Workflow

#### ç¼ºç‚¹

- ç¬¬ä¸€æ¬¡å…‹éš†å¾ˆæ…¢
- å æ®çš„å­˜å‚¨ç©ºé—´è¾ƒå¤§
- å¤ªå¤æ‚çš„äºŒè¿›åˆ¶æˆ–XMLæ–‡ä»¶å¤„ç†æ•ˆæœä¸å¦‚é›†ä¸­å¼



## äºŒã€workflowå·¥ä½œæµ

å·¥ä½œæµï¼Œå³åˆ†æ”¯ç®¡ç†ç­–ç•¥ï¼Œåˆ¶å®šåˆ†æ”¯æ¨¡å‹ï¼Œæ›´å¥½çš„ç®¡ç†ç‰ˆæœ¬è¿­ä»£ã€ç‰ˆæœ¬å‘å¸ƒç­‰

### 1. Git Flow

- é•¿æœŸåˆ†æ”¯ï¼šmasterã€dev
- é˜¶æ®µè¾…åŠ©åˆ†æ”¯ï¼šåŠŸèƒ½ featureã€è¡¥ä¸ hotfix ã€é¢„å‘ release
- ç‰ˆæœ¬è®°å½•ï¼šé€šè¿‡ master ä¸Šçš„ tag æ¥è®°å½•

### 2. GitHub Flow

- é•¿æœŸåˆ†æ”¯ï¼šmasterï¼Œè¢«protectedï¼Œæäº¤æƒé™æ¯”è¾ƒä¸¥æ ¼ï¼Œæ°¸è¿œæ˜¯å¯å‘å¸ƒçŠ¶æ€

### 3. GitLab Flow

- Environment Branchesï¼Œæ¯ä¸ªç¯å¢ƒï¼Œéƒ½å¯¹åº”ä¸€ä¸ªåˆ†æ”¯ã€‚prodution åˆ†æ”¯ä¸“é—¨ç”¨æ¥å‘å¸ƒç‰ˆæœ¬ï¼Œpre-productioné¢„å‘ã€test-productionæµ‹è¯•ã€‚
- Upstream Firstã€‚ä»£ç åˆå¹¶çš„é¡ºåºï¼Œè¦æŒ‰ç¯å¢ƒä¾æ¬¡æ¨é€ï¼Œç¡®ä¿ä»£ç è¢«å……åˆ†æµ‹è¯•è¿‡ï¼Œæ‰ä¼šä»ä¸Šæ¸¸åˆ†æ”¯åˆå¹¶åˆ°ä¸‹æ¸¸åˆ†æ”¯ã€‚ï¼ˆğŸŒ°: feature=>dev=>productionï¼‰



## ä¸‰ã€HEADã€å·¥ä½œæ ‘ã€ç´¢å¼•

æ‰“å¼€ `.git` æ–‡ä»¶æ¥çœ‹

### HEAD

> ref: refs/heads/branch_name
>
> > æŒ‡å‘ `.git/refs/heads/branch_name` ï¼Œå…¶ä¸­ä¿å­˜äº†æœ€æ–°çš„æäº¤å³ commitId
>
> HEADæŒ‡é’ˆ => åˆ†æ”¯æŒ‡é’ˆ => æœ€æ–°æäº¤

#### detached head

å¦‚æœä½¿ç”¨çš„æ˜¯ `git checkout < commit id>`ï¼Œå³åˆ‡æ¢åˆ°æŒ‡å®šçš„æŸä¸€æ¬¡æäº¤ï¼ŒHEAD å°±ä¼šå¤„äº detached çŠ¶æ€ï¼ˆæ¸¸ç¦»çŠ¶æ€ï¼‰

detached çŠ¶æ€æœ‰åˆ©æœ‰å¼Šï¼Œå¯ä»¥ä½œä¸´æ—¶åˆ†æ”¯ï¼Œä¿å­˜ä¸´æ—¶çŠ¶æ€ç­‰ï¼Œè¿˜æ˜¯è°¨æ…ä½¿ç”¨ï¼ŒåŠæ—¶åˆ‡å›å…¶ä»–åˆ†æ”¯HEADã€‚



### HEAD^ and HEAD~

> 1. `~n` è¡¨ç¤ºå‘ä¸Šå–åˆ°ç¬¬ n ä¸ªç¥–å…ˆï¼Œ`^n` è¡¨ç¤ºç¬¬ n ä¸ª parent
> 2. `HEAD~` ç­‰ä»·äº `HEAD^`ï¼Œ`~3` ç­‰ä»·äº `^1^1^1` ç­‰ä»·äº `^^^`
> 3. `~` é€‚ç”¨äºçº¿æ€§æƒ…å†µï¼Œ`^` é€‚ç”¨äºåˆ†å‰æƒ…å†µï¼Œå¯ä»¥ç»„åˆä½¿ç”¨ï¼Œä¾‹å¦‚ `HEAD~3^2`

**æœ‰å¤šä¸ªparentçš„åˆ†å‰æƒ…å†µ**

- åˆ›å»ºæ–°åˆ†æ”¯ç„¶ååœ¨æ–°åˆ†æ”¯ä¸Šæäº¤
- åˆ†æ”¯è½åï¼Œæœ¬åœ°çš„commitä¸è½ä¸‹çš„commitç›´æ¥ä½¿ç”¨`git merge`åˆå¹¶
- ...

<img src="https://i.stack.imgur.com/pDAzG.png" style="zoom:75%;" />

### å·¥ä½œæ ‘ & ç´¢å¼•

å·¥ä½œæ ‘ï¼ˆworkspaceï¼Œå·¥ä½œåŒºï¼‰ã€ç´¢å¼•ï¼ˆindexï¼Œæš‚å­˜åŒº / staging areaï¼‰

åœ¨æ•°æ®åº“å’Œå·¥ä½œæ ‘ä¹‹é—´æœ‰ç´¢å¼•ï¼Œç´¢å¼•æ˜¯ä¸ºäº†å‘æ•°æ®åº“æäº¤ä½œå‡†å¤‡çš„åŒºåŸŸï¼Œä¹Ÿè¢«ç§°ä¸ºæš‚å­˜åŒºåŸŸã€‚

1. the **workspace** is the directory tree of (source) files that you see and edit.
2. The **index** is a single, large, binary file in `<baseOfRepo>/.git/index`, which lists all files in the current branch, their *sha1* checksums, time stamps and the file name -- it is not another directory with a copy of files in it.
3. The **local repository** is a hidden directory (`.git`) including an `objects` directory containing all versions of every file in the repo (local branches and copies of remote branches) as a compressed "blob" file.



## å»¶ä¼¸é—®é¢˜

::: details ä¸€ã€é›†ä¸­å¼ VS åˆ†å¸ƒå¼

éƒ½æ˜¯ä¸ºäº†å®ç°ç‰ˆæœ¬æ§åˆ¶ï¼Œè®°å½•æ–‡ä»¶å˜æ›´å†å²ï¼Œä¾¿äºå›¢é˜Ÿåä½œå¼€å‘ã€‚

**é›†ä¸­å¼**æœ€å¤§çš„ç‰¹ç‚¹åœ¨äºï¼Œç‰ˆæœ¬åº“åªä¿å­˜åœ¨ä¸­å¤®æœåŠ¡å™¨ä¸Šï¼Œå¼€å‘è€…çš„å¤§å¤šæ•°å·¥ä½œéƒ½éœ€è¦è”ç½‘ä¸ä¸­å¤®æœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼›å¯¹äºåŒå—ä»£ç çš„ä¿®æ”¹ï¼Œéœ€è¦å‰ä¸€ä¸ªäººçš„æ›´æ–°å…ˆæäº¤ï¼Œè§£å†³å®Œåˆå¹¶å†²çªä»¥åï¼Œè‡ªå·±çš„æ›´æ–°æ‰èƒ½æäº¤ã€‚é›†ä¸­å¼çš„ä¼˜åŠ¿åœ¨äºå¯¹å¤æ‚çš„äºŒè¿›åˆ¶æ–‡ä»¶å¤„ç†æ–¹å¼è¾ƒå¥½ï¼ŒåŒæ—¶æ“ä½œæ›´ç®€å•ï¼Œé€‚åˆæ²Ÿé€šæ–¹ä¾¿çš„å°å›¢é˜Ÿã€‚ä½†åŠ£åŠ¿æ›´æ˜æ˜¾ï¼Œå•ç‚¹æ•…éšœä¼šå¯¼è‡´ç‰ˆæœ¬æ•°æ®ä¸¢å¤±ï¼Œå¼€å‘è€…çš„å‘½ä»¤éƒ½éœ€è¦è”ç½‘æ“ä½œç­‰ç­‰æƒ…å†µéƒ½å¯èƒ½é™ä½å¼€å‘æ•ˆç‡ã€‚ç°åœ¨ä¸»è¦çš„é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶å·¥å…·æœ‰SVNå’ŒCVSã€‚

**åˆ†å¸ƒå¼**æœ€å¤§çš„ç‰¹ç‚¹åœ¨äºï¼Œå¼€å‘è€…çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥ç»´æŠ¤ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬åº“ï¼Œä¸­å¤®æœåŠ¡å™¨çš„ä½œç”¨åœ¨äºè®©å¼€å‘è€…ä¹‹é—´å¯ä»¥äº¤æ¢ä»£ç æ›´æ–°ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒæœåŠ¡å™¨çš„æ•…éšœé—®é¢˜ã€‚åŒæ—¶å¯ä»¥æ”¯æŒç¦»çº¿å·¥ä½œï¼ŒæŸ¥è¯¢ç‰ˆæœ¬å†å²ã€ä»£ç æäº¤ç­‰ç­‰éƒ½å¯ä»¥åœ¨æœ¬åœ°å®Œæˆã€‚åº”ç”¨æœ€å¹¿çš„å·¥å…·å°±æ˜¯Gitï¼ŒGité€Ÿåº¦å¾ˆå¿«ï¼ŒåŒæ—¶åˆæœ‰åˆ†æ”¯ç®¡ç†ã€æš‚å­˜åŒºç­‰å¼ºå¤§åŠŸèƒ½ã€‚

:::

::: details äºŒã€Git ä¸­ HEADã€å·¥ä½œæ ‘å’Œç´¢å¼•ä¹‹é—´çš„åŒºåˆ«ï¼Ÿ

HEADæŒ‡é’ˆä¿å­˜çš„refæŒ‡å‘åˆ†æ”¯æŒ‡é’ˆï¼Œåˆ†æ”¯æŒ‡é’ˆä¿å­˜çš„ä¸€ä¸ªcommitå“ˆå¸Œå€¼ï¼ŒæŒ‡å‘æœ€æ–°æäº¤ã€‚

å·¥ä½œæ ‘ç›¸å½“äºæ–‡ä»¶ç›®å½•æ ‘ï¼Œå·¥ä½œåŒºçš„ä¿®æ”¹å¯èƒ½ä¸éœ€è¦å…¨éƒ¨æäº¤ï¼Œå°±éœ€è¦é€šè¿‡æš‚å­˜åŒºï¼Œå³ä¸­é—´çš„ç´¢å¼•æ¥æŒ‡å®šè¦æäº¤çš„æ–‡ä»¶ã€‚å¯¹å¼€å‘è€…è€Œè¨€ï¼Œæš‚å­˜åŒºä¹Ÿå¯ä»¥è¢«ç”¨äºæ ¡éªŒé”™è¯¯ï¼Œä¾¿äºæ¢å¤ä»£ç çŠ¶æ€ã€‚

:::



# å‚è€ƒ

[èµ·æ­¥ - å…³äºç‰ˆæœ¬æ§åˆ¶](http://git-scm.com/book/zh/v2/%E8%B5%B7%E6%AD%A5-%E5%85%B3%E4%BA%8E%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6)

[What is a centralized version control system](https://about.gitlab.com/topics/version-control/what-is-centralized-version-control-system/)

[åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶](https://zh.wikipedia.org/wiki/%E5%88%86%E6%95%A3%E5%BC%8F%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6)

[Gitä¸‰å¤§ç‰¹è‰²ä¹‹WorkFlow(å·¥ä½œæµ)](https://blog.csdn.net/qq_32452623/article/details/78905181)

[What's the difference between HEAD^ and HEAD~ in Git?](https://stackoverflow.com/questions/2221658/whats-the-difference-between-head-and-head-in-git)

[What's the difference between HEAD, working tree and index, in Git?](https://stackoverflow.com/questions/3689838/whats-the-difference-between-head-working-tree-and-index-in-git)

